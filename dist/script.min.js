/* ClipPop v1.0.5 Copyright 2025 withApps Licensed under Creative Commons Legal Code (https://github.com/withapps/ClipPop/blob/main/LICENSE)*/'use strict';(function(y,r){const ba=navigator.userAgent;var M=y.location.pathname;const H=r.querySelectorAll.bind(r),v=r.querySelector.bind(r),J=atob,T=(new RegExp("[?&]"+encodeURIComponent("mid")+"=([^&]*)")).exec(r.currentScript.src)[1],U=(new RegExp("[?&]"+encodeURIComponent("client_id")+"=([^&]*)")).exec(r.currentScript.src)[1],qa=b=>{b=H(b);try{return b[0].getAttribute("content")}catch(a){return""}},ra=-1!=M.indexOf("popup/popup_index.html")||-1!=M.indexOf("protected/loginSns.html")||y.top!==y.self?!0:!1,G=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(ba)?!0:!1,sa=(M=M.match(/\/skin-([a-z0-9]+)\/?/))&&M[0]?M[0]:"",ca=J("aHR0cHM6Ly93d3cueW91dHViZS5jb20vaWZyYW1lX2FwaQ=="),ta=localStorage.getItem("clippop_debug")||!1;if(!T||!U||ra)return!1;let I="",n={},N=-1,R=0,O=!0,l="",K=!0,D=!1,B=0,C=0,S="object"===typeof CAFE24&&"undefined"!==typeof CAFE24.SDE_SHOP_NUM?CAFE24.SDE_SHOP_NUM:null;const w=(...b)=>{ta&&console.log(...b)},ua=function(b){return new Promise(function(a,c){(function(f){f.get(b,function(d,g){d&&w("%c "+d+" ","background:#ff0000;color:#fff;");d?c(d):a(g)})})(CAFE24API.init({client_id:U}))})},E=(b,a={})=>{b=r.createElement(b);a.id&&(b.id=a.id);a.class&&(Array.isArray(a.class)?b.classList.add(...a.class):"string"===typeof a.class&&(b.className=a.class));if(a.attributes)for(var c in a.attributes)a.attributes.hasOwnProperty(c)&&b.setAttribute(c,a.attributes[c]);a.textContent?b.textContent=a.textContent:a.htmlContent&&(b.innerHTML=a.htmlContent);if(a.parentNode){if("string"===typeof a.parentNode){if(c=r.getElementById(a.parentNode),!c)return w(`%c Parent element with ID ${a.parentNode} not found.`,"background:#ff0000;color:#fff;"),b}else if(a.parentNode instanceof HTMLElement)c=a.parentNode;else return w("%c Invalid parentNode option.","background:#ff0000;color:#fff;"),b;c.appendChild(b)}return b},V=(b,a)=>{let c=b?b.toLocaleString("ko-KR"):"";if(b&&a){var f=0===b||0===a||a>=b?0:Math.ceil((b-a)/b*100);f&&(c=`<strike>${b.toLocaleString("ko-KR")}</strike><salerate>${f}</salerate>${a.toLocaleString("ko-KR")}`)}return c},W=(b,a,c)=>{b||(b="https://placehold.co/100x100?text=CLIP");return`            <div class="cp-shortform-img"><img src="${b}" loading="lazy"></div>            <div class="cp-shortform-desc">                <div class="cp-shortform-title">${a}</div>                <div class="cp-shortform-price">${c}</div>            </div>                `},da=()=>{!K&&n[l].isMuted()?n[l].unMute():K&&!n[l].isMuted()&&n[l].mute()},P=()=>{w("check playing state: ",l,D);if(l&&!D){var b=n[l].type||"";b=`#clippop-player-container-${!b||"instagram"!=b&&"etc"!=b?"youtube":b}-${l}`;var a=v(b);a?(b=a.getBoundingClientRect(),b=0<=b.top&&0<=b.left&&b.bottom<=window.innerHeight&&b.right<=window.innerWidth):(console.warn(`Element with ID "${b}" not found.`),b=!1);"function"===typeof n[l].getPlayerState&&(a=n[l].getPlayerState(),b&&a!==YT.PlayerState.PLAYING&&(n[l].playVideo(),w("restart playing: ",l)))}},ea=()=>{const b=v("#clippop-link-to-origin-btn");l&&n[l]&&(b.style.visibility="instagram"==(n[l].type||"")?"visible":"hidden")},va=b=>{w(`ClipPop ready for youtube: ${b.target.getVideoData().video_id}`)},fa=()=>{if(1<R){const b=v("#clippop-scroll-down-btn"),a=new Event("click",{bubbles:!0,cancelable:!0});b.dispatchEvent(a)}else n[l]&&(n[l].seekTo(0),n[l].playVideo())},wa=b=>{const a=b.target.getVideoData().video_id;b.data===YT.PlayerState.ENDED?fa():b.data===YT.PlayerState.PAUSED?setTimeout(P,1500):b.data===YT.PlayerState.PLAYING&&(l=a,ea(),da(),D&&n[a].pauseVideo())},ha=(b,a,c)=>{let f;return(...d)=>{const g=this,e=c&&!f;clearTimeout(f);f=setTimeout(()=>{f=null;c||b.apply(g,d)},a);e&&b.apply(g,d)}},xa=(b,a)=>{b.forEach(c=>{var f=c.target,d=c.isIntersecting,g=f.getAttribute("data-video-type");const e=f.getAttribute("data-video-id");c=null;if("youtube"===g||"instagram"===g||"etc"===g)if(c=e,!c||!n[c])return;g=Array.from(H(".cp-shortform-video"));f=g.indexOf(f);if(d){if(f!==N){if(-1!==N&&(d=g[N].getAttribute("data-video-id"))&&n[d])try{n[d].seekTo(0),n[d].pauseVideo(),n[d].mute()}catch(k){w(`%c prev pauseback failed: ${k}`,"background:#ff0000;color:#fff;"),setTimeout(P,1500)}if(c){if(n[c])try{D||n[c].playVideo()}catch(k){w(`%c playback failed: ${k}`,"background:#ff0000;color:#fff;"),l=c,setTimeout(P,1500)}else w("%c playback not found","background:#ff0000;color:#fff;");N=f}}}else if(c&&l!=c&&n[c])try{n[c].seekTo(0),n[c].pauseVideo(),n[c].mute()}catch(k){w(`%c pauseback failed: ${k}`,"background:#ff0000;color:#fff;"),setTimeout(P,1500)}})},ia=()=>{const b=new IntersectionObserver(xa,{root:null,rootMargin:"0px",threshold:.8});Array.from(H(".cp-shortform-video")).forEach((a,c)=>{a.getAttribute("data-video-id")&&b.observe(a)})},za=b=>{const a=v("#clippop-shortform-container-wrapper-"+I),c=v("#clippop-top-btn-container"),f=v("#clippop-link-to-origin-btn"),d=v("#clippop-close-player-btn"),g=v("#clippop-mute-player-btn");let e=!1,k,t,q=null;const p=h=>{if("mousedown"!==h.type||0===h.button){e=!0;var z=a.getBoundingClientRect();if("touchstart"===h.type){if(!h.target||!h.target.id||"clippop-buttons-container"!=h.target.id)return;var F=h.touches[0];var Q=F.clientX;F=F.clientY}else Q=h.clientX,F=h.clientY;k=Q-z.left;t=F-z.top;a.style.cursor="grabbing";r.body.classList.add("cp-shortform-container-dragging");G?(r.addEventListener("touchmove",x),r.addEventListener("touchend",m)):(r.addEventListener("mousemove",x),r.addEventListener("mouseup",m));h.preventDefault()}},x=h=>{if(e){if("touchmove"===h.type){h=h.touches[0];var z=h.clientX;h=h.clientY}else z=h.clientX,h=h.clientY;B=z-k;C=h-t;B=Math.max(0,Math.min(y.innerWidth-a.offsetWidth,B));C=Math.max(0,Math.min(y.innerHeight-a.offsetHeight,C));a.style.left=B+"px";a.style.top=C+"px";a.style.bottom="auto";a.style.right="auto"}},m=()=>{e&&(e=!1,a.style.cursor="grab",r.body.classList.remove("cp-shortform-container-dragging"),G?(r.removeEventListener("touchmove",x),r.removeEventListener("touchend",m),L()):(r.removeEventListener("mousemove",x),r.removeEventListener("mouseup",L)))},u=()=>{L(!0,!1)},A=()=>{let h=!1;const z=y.innerWidth-a.offsetWidth,F=y.innerHeight-a.offsetHeight;0>B?(B=0,h=!0):B>z&&(B=z,h=!0);0>C?(C=0,h=!0):C>F&&(C=F,h=!0);h&&(a.style.transition="all 0.3s ease",a.style.left=B+"px",a.style.top=C+"px",a.style.bottom="auto",a.style.right="auto",setTimeout(()=>{a.style.transition=""},300))},X=()=>{setTimeout(A,900)},L=(h=!0,z=!0)=>{clearTimeout(q);c.style.display=h?"flex":"none";h&&z&&!O&&(q=setTimeout(L,5E3,!1))},ja=h=>{h.preventDefault();h.stopPropagation();a.classList.remove("cp-shortform-container-pip-wrapper");a.classList.add("cp-shortform-container-wrapper");a.style.top="0px";a.style.left="0px";G?(a.removeEventListener("touchstart",p),y.removeEventListener("orientationchange",X)):(a.removeEventListener("mousedown",p),a.removeEventListener("mouseover",u),a.removeEventListener("mouseout",L));a.style.cursor="default";Y(!0)},Y=h=>{O=h;var z=v("#clippop-fullscreen-player-btn"),F=v("#clippop-buttons-container");const Q=v("#clippop-play-btn-container"),ka=v("#clippop-scroll-btn-container");z&&(z.style.display=h?"none":"block",h?(z.removeEventListener("click",ja),F.style.pointerEvents="none",Q.style.visibility="visible",ka.style.visibility="visible",f.style.display="block",r.body.classList.add("cp-shortform-container-no-scroll")):(z.addEventListener("click",ja),F.style.pointerEvents="inherit",Q.style.visibility="hidden",ka.style.visibility="hidden",r.body.classList.remove("cp-shortform-container-no-scroll"),G?(a.addEventListener("touchstart",p),y.addEventListener("orientationchange",X),f.style.display="none"):(f.style.display="block",a.addEventListener("mousedown",p),a.addEventListener("mouseover",u),a.addEventListener("mouseout",L)),a.style.cursor="grab"));l&&(h=l)&&(z=v("#clippop-shortform-container"),(F=v(`.cp-shortform-video[data-video-id="${h}"]`))?z.scrollTo(0,F.offsetTop):console.warn(`Video element with ID "${h}" not found.`));L()},ya=h=>{h.preventDefault();h.stopPropagation();if(O){a.classList.remove("cp-shortform-container-wrapper");a.classList.add("cp-shortform-container-pip-wrapper");if(0!=B||0!=C)a.style.top=C+"px",a.style.left=B+"px";Y(!1);D&&(h=new Event("click",{bubbles:!0,cancelable:!0}),G?a.dispatchEvent(h):v("#clippop-play-stop-btn").dispatchEvent(h))}else Z()},ma=h=>{n[l]&&(h?n[l].mute():n[l].unMute(),K=h,la(K))},la=h=>{g.innerHTML=h?'\n            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">\n                <path d="M6.717 3.55A.5.5 0 0 1 7 4v8a.5.5 0 0 1-.812.39L3.825 10.5H1.5A.5.5 0 0 1 1 10V6a.5.5 0 0 1 .5-.5h2.325l2.363-1.89a.5.5 0 0 1 .529-.06M6 5.04 4.312 6.39A.5.5 0 0 1 4 6.5H2v3h2a.5.5 0 0 1 .312.11L6 10.96zm7.854.606a.5.5 0 0 1 0 .708L12.207 8l1.647 1.646a.5.5 0 0 1-.708.708L11.5 8.707l-1.646 1.647a.5.5 0 0 1-.708-.708L10.793 8 9.146 6.354a.5.5 0 1 1 .708-.708L11.5 7.293l1.646-1.647a.5.5 0 0 1 .708 0"/>\n            </svg>\n            ':'\n            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"viewBox="0 0 16 16">\n                <path d="M11.536 14.01A8.47 8.47 0 0 0 14.026 8a8.47 8.47 0 0 0-2.49-6.01l-.708.707A7.48 7.48 0 0 1 13.025 8c0 2.071-.84 3.946-2.197 5.303z"/>\n                <path d="M10.121 12.596A6.48 6.48 0 0 0 12.025 8a6.48 6.48 0 0 0-1.904-4.596l-.707.707A5.48 5.48 0 0 1 11.025 8a5.48 5.48 0 0 1-1.61 3.89z"/>\n                <path d="M10.025 8a4.5 4.5 0 0 1-1.318 3.182L8 10.475A3.5 3.5 0 0 0 9.025 8c0-.966-.392-1.841-1.025-2.475l.707-.707A4.5 4.5 0 0 1 10.025 8M7 4a.5.5 0 0 0-.812-.39L3.825 5.5H1.5A.5.5 0 0 0 1 6v4a.5.5 0 0 0 .5.5h2.325l2.363 1.89A.5.5 0 0 0 7 12zM4.312 6.39 6 5.04v5.92L4.312 9.61A.5.5 0 0 0 4 9.5H2v-3h2a.5.5 0 0 0 .312-.11"/>\n            </svg>\n            '};f&&f.addEventListener("click",h=>{h.preventDefault();h.stopPropagation();l&&n[l]&&(h=n[l].link)&&(ma(!0),y.open(h,"_blank"))});d&&d.addEventListener("click",ya);g&&(g.addEventListener("click",h=>{h.preventDefault();h.stopPropagation();ma(!K)}),la(K));(()=>{const h=a.getBoundingClientRect();B=h.left;C=h.top})();Y("pip"!=b)},Aa=()=>{const b=v("#clippop-shortform-container-wrapper-"+I),a=v("#clippop-shortform-container"),c=v("#clippop-scroll-btn-container"),f=v("#clippop-play-stop-btn");let d=null,g=null;const e=()=>{(()=>{f.style.display="block";f.classList.add("cp-animation-fade-in");d=setTimeout(()=>{f.classList.remove("cp-animation-fade-in");f.classList.add("cp-animation-fade-out");g=setTimeout(()=>{f.classList.remove("cp-animation-fade-out");f.style.display="none";f.style.opacity=0},2E3)},700)})()},k=()=>{n[l]&&(D?(w("ClipPop Stop for video ID: ",l),n[l].pauseVideo()):(w("ClipPop Play for video ID: ",l),n[l].playVideo()))},t=m=>{m.preventDefault();m.stopPropagation();D=!D;k();m=D?'\n            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">\n                <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/>\n                <path d="M6.271 5.055a.5.5 0 0 1 .52.038l3.5 2.5a.5.5 0 0 1 0 .814l-3.5 2.5A.5.5 0 0 1 6 10.5v-5a.5.5 0 0 1 .271-.445"/>\n            </svg>\n            ':'\n            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-stop-circle" viewBox="0 0 16 16">\n                <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/>\n                <path d="M5 6.5A1.5 1.5 0 0 1 6.5 5h3A1.5 1.5 0 0 1 11 6.5v3A1.5 1.5 0 0 1 9.5 11h-3A1.5 1.5 0 0 1 5 9.5z"/>\n            </svg>\n            ';clearTimeout(d);clearTimeout(g);f.innerHTML=m;f.className="cp-btn-animation-set";D?(f.style.display="block",f.classList.add("cp-animation-fade-in")):e()},q=()=>{D=r.hidden;k()},p=m=>{const u=250<=m?"":"none";Array.from(H("#clippop-shortform-container-wrapper-"+I+" .cp-shortform-info")).forEach((A,X)=>{A.style.display=u});c.style.display=120<=y.innerWidth-m?"flex":"none"},x=new ResizeObserver(m=>{for(let u of m)m=u.contentRect.width,ha(p,500)(m)});G?b.addEventListener("click",t):(a.addEventListener("click",t),f.addEventListener("click",t));f.style.display="none";x.observe(a);r.removeEventListener("visibilitychange",q);r.addEventListener("visibilitychange",q)},Ba=()=>{const b=v("#clippop-shortform-container");var a=e=>{e.preventDefault();e.stopPropagation();b.scrollBy({top:-b.offsetHeight,behavior:"smooth"})};const c=e=>{e.preventDefault();e.stopPropagation();5>=b.scrollHeight-b.clientHeight-b.scrollTop||N==R-1?b.scrollTo(0,0):b.scrollBy({top:b.offsetHeight,behavior:"smooth"})},f=()=>{const e=v("#clippop-scroll-up-btn"),k=v("#clippop-scroll-down-btn"),t=0>=b.scrollTop,q=5>=b.scrollHeight-b.clientHeight-b.scrollTop;e&&(e.disabled=t,e.style.opacity=t?"0.5":"1",e.style.cursor=t?"default":"pointer");k&&(k.disabled=q,k.style.opacity=q?"0.5":"1",k.style.cursor=q?"default":"pointer")},d=v("#clippop-scroll-up-btn"),g=v("#clippop-scroll-down-btn");d&&d.addEventListener("click",a);g&&g.addEventListener("click",c);a=ha(f,200);b.addEventListener("scroll",a);f()},Ca=()=>{H("[data-clippop-uid]").forEach(b=>{const a=b.getAttribute("data-clippop-uid");a&&(b.style.cursor="pointer",b.addEventListener("click",()=>{const c=v(J("I2NsaXBwb3Atc2hvcnRmb3JtLWNvbnRhaW5lci13cmFwcGVyLQ==")+a);c?O||(B=(y.innerWidth-c.offsetWidth)/2,C=(y.innerHeight-c.offsetHeight)/2,c.style.transition="all 0.3s ease",c.style.left=B+"px",c.style.top=C+"px",c.style.bottom="auto",c.style.right="auto",setTimeout(()=>{c.style.transition=""},300)):(Z(),na(a))}))})},Da=b=>{var a=H('[id^="clippop_inline_"]');if(0==a.length)w("ClipPop Inline Not Found");else{w("Start ClipPop Inline");var c=new Set,f=E("style",{type:"text/css",textContent:'\n        .cp-shortform-inline-container {\n            display: flex;\n            flex-direction: row;\n            overflow-x: auto;\n            padding: 20px 0;\n            width: 100%;\n            gap: var(--cp-gap-size, 15px);\n            scroll-snap-type: x mandatory;\n            scroll-behavior: smooth;\n            -webkit-overflow-scrolling: touch;\n            scrollbar-width: none;\n            -ms-overflow-style: none;\n        }\n        .cp-shortform-inline-container::-webkit-scrollbar { display: none; }\n        .cp-shortform-inline-item {\n            flex: 0 0 auto;\n            position: relative;\n            border-radius: 12px;\n            overflow: hidden;\n            background: #000;\n            scroll-snap-align: center;\n            width: var(--cp-item-width, 315px);\n            aspect-ratio: 9 / 16;\n            height: auto; \n        }\n        .cp-shortform-inline-iframe {\n            border: none;\n            width: 100%;\n            height: 100%;\n            object-fit: cover;\n            pointer-events: auto;\n        }\n        .cp-shortform-inline-item-info {\n            position: absolute;\n            bottom: 10px;\n            left: 10px;\n            width: calc(100% - 20px);\n            box-sizing: border-box;\n            padding: .3rem;\n            display : flex;\n            justify-content : flex-start;\n            background: rgba(255,255,255,0.5);\n            -webkit-backdrop-filter:blur(10px);\n            backdrop-filter:blur(10px);\n            border-radius: 10px;\n            cursor: pointer;\n            z-index: 2;\n        }\n        .cp-shortform-inline-item-info:hover {\n            background-color: #fff;\n        }\n        .cp-shortform-inline-item-img img{\n            width: 4em;\n            height: 4em;\n            object-fit: cover;\n            padding: .2rem;\n            background-color: #fff;\n            border: 1px solid #ccc;\n            border-radius: 10px;\n            max-height: 100%;\n            vertical-align: middle;\n            box-sizing: border-box;\n        }\n        .cp-shortform-inline-item-desc {\n            width: calc(100% - 90px);\n            margin-left:10px;\n            display : flex;\n            flex-direction: column;\n            justify-content: center;\n        }\n        .cp-shortform-inline-item-title { width: 100%; font-weight: bold; margin-bottom: .2em; overflow: hidden; white-space: nowrap; word-break: break-all; text-overflow: ellipsis;}\n        .cp-shortform-inline-item-price { width: 100%; font-size: 0.9em; font-weight: bold; overflow: hidden; white-space: nowrap; word-break: break-all; text-overflow: ellipsis;}\n        .cp-shortform-inline-item-price strike { font-size: 0.9em; font-weight: normal; color: #555;}\n        .cp-shortform-inline-item-price salerate { color: #ff0000; margin: 0 5px;}\n        .cp-shortform-inline-item-price salerate::after { font-size: 0.7em; font-weight: normal; content: "%";}\n        @media (max-width: 768px) {\n            .cp-shortform-inline-container {\n                padding: 20px;\n            }\n            .cp-shortform-inline-item {\n                width: 80vw !important; \n                max-width: 320px;\n            }\n        }\n        '});r.head.appendChild(f);var d=new IntersectionObserver(e=>{e.forEach(k=>{const t=k.target.querySelector("iframe");if(t){var q=(p,x=[])=>{t.contentWindow.postMessage(JSON.stringify({event:"command",func:p,args:x}),"*")};k.isIntersecting?q("playVideo"):(q("pauseVideo"),q("seekTo",[0,!0]))}})},{root:null,rootMargin:"0px",threshold:.7}),g=y.location.origin;a.forEach(e=>{const k=e.getAttribute("id").replace("clippop_inline_","");if(c.has(k))e.remove();else{c.add(k);e.classList.add("cp-shortform-inline-container");var t=e.getAttribute("data-clippop-width"),q=e.getAttribute("data-clippop-gap");t&&e.style.setProperty("--cp-item-width",t+"px");q&&e.style.setProperty("--cp-gap-size",q+"px");if(t=b.find(p=>p.location.includes("INLINE:"+k)))e.innerHTML="",t.clip_data.forEach(p=>{const x=E("div",{class:"cp-shortform-inline-item",attributes:{}});var m=`https://www.youtube.com/embed/${p.id}?enablejsapi=1&origin=${g}&mute=1&rel=0&controls=0&loop=1&playlist=${p.id}&playsinline=1`;m="instagram"==p.type||"etc"==p.type?E("div",{class:"cp-shortform-inline-iframe"}):E("iframe",{class:"cp-shortform-inline-iframe",attributes:{src:m,allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullscreen:"true"}});var u="";if(p.product&&0<p.product.length){u=p.product[0];var A=V(u.price,u.sale);A=W(u.img,u.name,A);u=`<div class="cp-shortform-inline-item-info" data-product-no="${u.no}">${A}</div>`}p="instagram"==p.type||"etc"==p.type?`<video poster="${p.thum}" src="${p.url}" muted playsinline style="width: 100%; height: 100%; object-fit: contain;"></video>`:"";A=`                        ${p}                        ${u}                    `;x.appendChild(m);(u||p)&&x.insertAdjacentHTML("beforeend",A);e.appendChild(x);d.observe(x)})}});a=Array.from(H(".cp-shortform-inline-container .cp-shortform-inline-item-info"));oa(a)}},Ea=b=>{const a=H("img[data-clippop-embed]");if(0==a.length)w("ClipPop Embed Not Found");else{w("Start ClipPop Embed");var c=new IntersectionObserver(d=>{d.forEach(g=>{const e=g.target.querySelector("iframe");if(e){var k=(t,q=[])=>{e.contentWindow.postMessage(JSON.stringify({event:"command",func:t,args:q}),"*")};g.isIntersecting?k("playVideo"):(k("pauseVideo"),k("seekTo",[0,!0]))}})},{root:null,rootMargin:"0px",threshold:.7}),f=y.location.origin;a.forEach(d=>{const g=d.getAttribute("data-clippop-embed"),e=d.getAttribute("data-clippop-align");if(g){const k=d.parentNode;k&&b.forEach(t=>{t.clip_data.forEach(q=>{q.product&&q.product.forEach(p=>{if(p.no==parseInt(g)){var x=d.offsetWidth,m=d.offsetHeight;p=r.createElement("div");p.style.cssText=`position: absolute;top: 0;left: 0;display: flex, justify-content: center, align-items: center; width: ${x}px; height: ${m}px; overflow:hidden`;k.appendChild(p);var u=`https://www.youtube.com/embed/${q.id}?enablejsapi=1&origin=${f}&mute=1&rel=0&controls=0&loop=1&playlist=${q.id}&playsinline=1`;u="instagram"==q.type||"etc"==q.type?E("div",{class:"cp-shortform-inline-iframe"}):E("iframe",{attributes:{src:u,allow:"accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture",allowFullscreen:"true"}});const A=16/9*x;m=(A-m)/2*-1;e&&("top"==e?m=0:"bottom"==e&&(m*=2));u.style.cssText=`position: absolute;top:${m}px;left:0;width: ${x}px; height: ${A}px;`;p.appendChild(u);if("instagram"==q.type||"etc"==q.type)u.innerHTML=`<video poster="${q.thum}" src="${q.url}" muted playsinline style="width: 100%; height: 100%; object-fit: contain;"></video>`;x=r.createElement("div");x.style.cssText="position: absolute;top: 0;left: 0;width: 100%;height: 100%;";p.appendChild(x);c.observe(p)}})})})}})}},aa=()=>{Array.from(H("#clippop-shortform-container-wrapper-"+I+" .cp-shortform-video")).forEach((b,a)=>{a=b.getAttribute("data-video-type");const c=b.getAttribute("data-video-id"),f=b.getAttribute("data-video-link"),d=`clippop-player-container-${a}-${c}`;w(`Initializing ClipPop video ID: ${c}`);if("youtube"===a)c&&r.getElementById(d)?n[c]=new YT.Player(d,{height:"100%",width:"100%",videoId:c,playerVars:{enablejsapi:1,autoplay:0,controls:0,playsinline:1,mute:1,rel:0,loop:1,showinfo:0,origin:y.location.origin},events:{onReady:va,onStateChange:wa}}):console.warn(`ClipPop container not found or video ID missing for YouTube element: ${c}`);else if("instagram"===a||"etc"===a){const g=v("#"+d+" video");c&&g?(w(`Embedding video for ID: ${c}`),g.addEventListener("ended",()=>{fa()}),n[c]={type:a,video_id:c,link:f,playVideo:()=>{if(g.paused)try{g.play(),l=c,ea(),da()}catch(e){w(`%c video player ${c} failed: ${e}`,"background:#ff0000;color:#fff;")}},pauseVideo:()=>{g.paused||(g.pause(),setTimeout(P,1500))},isMuted:()=>g.muted,mute:()=>{g.muted=!0},unMute:()=>{g.muted=!1},seekTo:e=>{g.currentTime=e},getPlayerState:()=>g.paused?2:1}):console.warn("Instagram embed wrapper not found or reel URL missing for Instagram element:",b)}})},oa=b=>{0!=b.length&&b.forEach((a,c)=>{const f=a.getAttribute("data-product-no");f&&(a.addEventListener("click",d=>{y.open(sa+J("L3Byb2R1Y3QvZGV0YWlsLmh0bWw/Z2hvc3RfbWFsbF9pZD1jbGlwcG9wJnByb2R1Y3Rfbm89")+f,"_blank");d.preventDefault();d.stopPropagation()}),U&&S&&ua(J("L2FwaS92Mi9wcm9kdWN0cy8=")+f+J("P2ZpZWxkcz1wcm9kdWN0X25hbWUscHJpY2UscmV0YWlsX3ByaWNlLGRpc3BsYXksc2VsbGluZyxsaXN0X2ltYWdlLGRpc2NvdW50cHJpY2UmZW1iZWQ9ZGlzY291bnRwcmljZSZzaG9wX25vPQ==")+S).then(async function(d){if(d.product)if("T"==d.product.display&&"T"==d.product.selling){var g=d.product.retail_price&&d.product.retail_price>d.product.price?d.product.retail_price:d.product.price;let e=d.product.retail_price&&d.product.retail_price>d.product.price?d.product.price:0;e=d.product.discountprice&&d.product.discountprice.pc_discount_price?parseInt(d.product.discountprice.pc_discount_price):e;G&&(e=d.product.discountprice&&d.product.discountprice.mobile_discount_price?parseInt(d.product.discountprice.mobile_discount_price):e);-1!=ba.indexOf("Cafe24Plus")&&(e=d.product.discountprice&&d.product.discountprice.app_discount_price?parseInt(d.product.discountprice.app_discount_price):e);g=V(parseInt(g),e);d=W(d.product.list_image,d.product.product_name,g);a.innerHTML=d}else a.remove()}).catch(function(d){w("callCafe24API error: ",d)}))})},Fa=()=>{if(y.YT&&y.YT.Player||v(`script[src="${ca}"]`))w("YouTube API already loaded"),aa(),ia();else{var b=r.createElement("script");b.src=ca;var a=r.getElementsByTagName("script")[0];a&&a.parentNode?a.parentNode.insertBefore(b,a):r.head.appendChild(b);b=J("b25Zb3VUdWJlSWZyYW1lQVBJUmVhZHk=");"function"!==typeof y[b]?y[b]=()=>{aa()}:setTimeout(aa,1E3);setTimeout(ia,2E3)}},pa=b=>{for(let a=b.length-1;0<a;a--){const c=Math.floor(Math.random()*(a+1));[b[a],b[c]]=[b[c],b[a]]}return b},Ga=(b,a)=>{w("ClipPop findMatchingProductClips for product no: ",a);const c=[];b.forEach(f=>{f&&Array.isArray(f.clip_data)&&f.clip_data.some(d=>d&&Array.isArray(d.product)?d.product.some(g=>g&&g.no===parseInt(a)):!1)&&c.push(f)});w("ClipPop findMatchingProductClips for product data: ",c);return c},Ha=(b,a)=>{w("ClipPop sortMatchingProductClips for product no: ",a);const c=(f,d)=>{f=Object.assign({},f);if(Array.isArray(f.product)){const g=[...f.product];g.sort((e,k)=>{const t=parseInt(d);e=e&&e.no===t;k=k&&k.no===t;return e&&!k?-1:!e&&k?1:0});f.product=g}return f};b=b.map(f=>c(f,a)).sort((f,d)=>{const g=parseInt(a);f=f.product&&f.product.some(e=>e&&e.no===g);d=d.product&&d.product.some(e=>e&&e.no===g);return f&&!d?-1:!f&&d?1:0});w("ClipPop sortMatchingProductClips for product data: ",b);return b},Z=()=>{l&&n[l]&&!D&&(D=!0,n[l].pauseVideo(),n[l].mute(),l="");H('[id^="clippop-shortform-container-wrapper-"]').forEach(b=>{b.remove()});n={};N=-1;R=0;O=!0;l="";K=!0;D=!1;C=B=0},Ia=(b,a,c,f)=>{I=b.clip_uid;const d=b.clip_index.full||99999,g=b.clip_index.pip||1E4;var e=G?b.loc_pip.mobile.loc:b.loc_pip.pc.loc;a&&(e="ct");a=G?b.loc_pip.mobile.mx:b.loc_pip.pc.mx;const k=G?b.loc_pip.mobile.my:b.loc_pip.pc.my;let t="auto",q="auto",p="auto",x="auto";"lb"==e?(p=k+"px",x=a+"px"):"lt"==e?(t=k+"px",x=a+"px"):"rb"==e?(p=k+"px",q=a+"px"):"rt"==e?(t=k+"px",q=a+"px"):"ct"==e&&(t="30%",x=G?"32%":"44%");a=`${t} ${q} ${p} ${x}`;e=G?b.loc_pip.mobile.pm:b.loc_pip.pc.pm;b=b.clip_index.rnd?pa(b.clip_data):[...b.clip_data];"PRODUCT_DETAIL"==c&&""!=f&&(b=Ha(b,f));R=b.length||0;c=`    .cp-shortform-container-wrapper {        display: flex;        position: fixed;        top: 0;        left: 0;        width: 100%;        height: 100%;        font-size: 16px;        background-color: rgba(0, 0, 0, 0.8);        z-index: ${d};        justify-content: center;        align-items: center;        overflow: hidden;    }    .cp-shortform-container-pip-wrapper {        display: flex;        position: fixed;        top: 0;        left: 0;        aspect-ratio: 9 / 16;        min-width: 145px;        width: 20%;        max-width: 300px;        height: auto;        font-size: 12px;        background-color: rgba(0, 0, 0, 0.8);        z-index: ${g};        justify-content: center;        align-items: center;        border-radius: 10px;        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);        overflow: hidden;        inset: ${a};    }    .cp-shortform-container-dragging {        cursor: grabbing !important;        user-select: none;        -webkit-user-select: none;        -moz-user-select: none;        -ms-user-select: none;            }    .cp-shortform-container-no-scroll{        overflow:hidden !important;    }     .cp-shortform-container {        aspect-ratio: 9 / 16;        height: 100%;        overflow-y: scroll;        scroll-snap-type: y mandatory;        -webkit-overflow-scrolling: touch;                position: relative;        &::-webkit-scrollbar {display: none;}        scrollbar-width: none;        -ms-overflow-style: none;            }    .cp-buttons-container {        display: flex;        position: absolute;        top: 0px;        left: 0px;                width: 100%;        height: 100%;    }    .cp-buttons-container:hover {        background-color: rgba(0, 0, 0, 0.5);    }            .cp-shortform-video {        height: 100%;        width: 100%;        display: flex;        justify-content: center;        align-items: center;        scroll-snap-align: start;        position: relative;        background-color: #000;        overflow: hidden;    }    .cp-player-wrapper iframe {        display: block;        width: 100%;        height: 100%;    }    .cp-shortform-overlay {        position: absolute;        top: 0;        left: 0;        width: 100%;        height: 100%;    }    .cp-shortform-info {        position: absolute;        bottom: 10px;        left: 10px;        width: calc(100% - 20px);        box-sizing: border-box;        padding: .3rem;        display : flex;        justify-content : flex-start;        background: rgba(255,255,255,0.5);        -webkit-backdrop-filter:blur(10px);        backdrop-filter:blur(10px);        border-radius: 10px;        cursor: pointer;        z-index: ${g};    }    .cp-shortform-info:hover {        background-color: #fff;    }    .cp-shortform-img img{        width: 4em;        height: 4em;        object-fit: cover;        padding: .2rem;        background-color: #fff;        border: 1px solid #ccc;        border-radius: 10px;        max-height: 100%;        vertical-align: middle;        box-sizing: border-box;    }    .cp-shortform-desc {        width: calc(100% - 90px);        margin-left:10px;        display : flex;        flex-direction: column;        justify-content: center;    }    .cp-shortform-title { width: 100%; font-weight: bold; margin-bottom: .2em; overflow: hidden; white-space: nowrap; word-break: break-all; text-overflow: ellipsis;}    .cp-shortform-price { width: 100%; font-size: 0.9em; font-weight: bold; overflow: hidden; white-space: nowrap; word-break: break-all; text-overflow: ellipsis;}    .cp-shortform-price strike { font-size: 0.9em; font-weight: normal; color: #555;}    .cp-shortform-price salerate { color: #ff0000; margin: 0 5px;}    .cp-shortform-price salerate::after { font-size: 0.7em; font-weight: normal; content: "%";}    .cp-top-btn-container {        position: absolute;        top: 0px;        left: 0px;        width: 100%;        padding: 10px;        display: flex;        justify-content: space-between;        box-sizing: border-box;    }    .cp-top-btn-container div{        display: flex;    }    .cp-top-btn-container svg, .cp-scroll-btn-container svg {        width: 32px;        height: 32px;    }            .cp-top-btn-container button, .cp-play-btn-container button, .cp-scroll-btn-container button {        width: 40px;        height: 40px;        background-color: transparent;        color: rgba(255, 255, 255, 0.8);        border: none;        border-radius: 50%;        cursor: pointer;        display: flex;        justify-content: center;        align-items: center;        line-height: 0.9;        pointer-events: auto;    }          .cp-top-btn-container button:hover, .cp-play-btn-container button:hover, .cp-scroll-btn-container button:hover {        color: white;    }    .cp-play-btn-container {        position: absolute;        top: calc(50% - 20px);        left: 0px;        width: 100%;        padding: 10px;        display : flex;        justify-content : center;        align-items: center;        box-sizing: border-box;    }    .cp-play-btn-container button {        width: 20%;        height: 20%;        min-width: 40px;        min-height: 40px;                max-width: 80px;        max-height: 80px;    }    .cp-play-btn-container svg {        width: 100%;        height: 100%;    }              .cp-scroll-btn-container {        position: absolute;        bottom: 0px;        left: 0px;        width: 100%;        padding: 10px;        display : flex;        flex-direction: column;        justify-content : flex-end;        align-items: end;        box-sizing: border-box;    }    .cp-btn-small svg {        width: 16px;        height: 16px;    }    .cp-btn-animation-set {        display: none;        opacity: 0;        will-change: opacity;        backface-visibility: hidden;        transform: translateZ(0);        visibility: visible;    }    .cp-animation-fade-in {        animation: cpAnimationFadeIn 0.5s ease-in forwards;    }    .cp-animation-fade-out {        animation: cpAnimationFadeOut 0.5s ease-out forwards;    }    @keyframes cpAnimationFadeIn {        0% { opacity: 0; }        100% { opacity: 1; }    }    @keyframes cpAnimationFadeOut {        0% { opacity: 1; }        100% { opacity: 0; }    }    @media (pointer: coarse) {        .cp-top-btn-container {            height: 60px;            background: linear-gradient(to bottom, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0) 100%);        }        .cp-top-btn-container button, .cp-play-btn-container button, .cp-scroll-btn-container button {            color: rgba(255, 255, 255, 1.0);        }        .cp-buttons-container:hover {            background-color: transparent;        }    }    `;v("#clippop-shortform-container-wrapper-"+I)&&Z();c=E("style",{type:"text/css",textContent:c});r.head.appendChild(c);c=E("div",{id:"clippop-shortform-container-wrapper-"+I,class:"cp-shortform-container"+("pip"==e?"-pip":"")+"-wrapper"});r.body.appendChild(c);E("div",{id:"clippop-shortform-container",class:"cp-shortform-container",parentNode:"clippop-shortform-container-wrapper-"+I});b.forEach(m=>{var u="";if(m.product&&0<m.product.length){u=m.product[0];var A=V(u.price,u.sale);A=W(u.img,u.name,A);u=`<div class="cp-shortform-info" data-product-no="${u.no}">${A}</div>`}E("div",{class:["cp-shortform-video","cp-"+m.type],attributes:{"data-video-type":m.type,"data-video-id":m.id,"data-video-link":m.link?m.link:""},parentNode:"clippop-shortform-container",htmlContent:`                <div id="clippop-player-container-${m.type}-${m.id}" class="cp-player-wrapper">${"instagram"==m.type||"etc"==m.type?`<video poster="${m.thum}" src="${m.url}" muted playsinline style="width: 100%; height: 100%; object-fit: contain;"></video>`:""}}</div>                <div class="cp-shortform-overlay"></div>                ${u}            `})});E("div",{id:"clippop-buttons-container",class:"cp-buttons-container",parentNode:"clippop-shortform-container-wrapper-"+I});E("div",{id:"clippop-top-btn-container",class:"cp-top-btn-container",parentNode:"clippop-buttons-container",htmlContent:'\n        <div>\n        <button id="clippop-link-to-origin-btn" title="Instagram\uc5d0\uc11c \ubcf4\uae30" style="display:none;visibility:hidden;">\n            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">\n                <path d="M8 0C5.829 0 5.556.01 4.703.048 3.85.088 3.269.222 2.76.42a3.9 3.9 0 0 0-1.417.923A3.9 3.9 0 0 0 .42 2.76C.222 3.268.087 3.85.048 4.7.01 5.555 0 5.827 0 8.001c0 2.172.01 2.444.048 3.297.04.852.174 1.433.372 1.942.205.526.478.972.923 1.417.444.445.89.719 1.416.923.51.198 1.09.333 1.942.372C5.555 15.99 5.827 16 8 16s2.444-.01 3.298-.048c.851-.04 1.434-.174 1.943-.372a3.9 3.9 0 0 0 1.416-.923c.445-.445.718-.891.923-1.417.197-.509.332-1.09.372-1.942C15.99 10.445 16 10.173 16 8s-.01-2.445-.048-3.299c-.04-.851-.175-1.433-.372-1.941a3.9 3.9 0 0 0-.923-1.417A3.9 3.9 0 0 0 13.24.42c-.51-.198-1.092-.333-1.943-.372C10.443.01 10.172 0 7.998 0zm-.717 1.442h.718c2.136 0 2.389.007 3.232.046.78.035 1.204.166 1.486.275.373.145.64.319.92.599s.453.546.598.92c.11.281.24.705.275 1.485.039.843.047 1.096.047 3.231s-.008 2.389-.047 3.232c-.035.78-.166 1.203-.275 1.485a2.5 2.5 0 0 1-.599.919c-.28.28-.546.453-.92.598-.28.11-.704.24-1.485.276-.843.038-1.096.047-3.232.047s-2.39-.009-3.233-.047c-.78-.036-1.203-.166-1.485-.276a2.5 2.5 0 0 1-.92-.598 2.5 2.5 0 0 1-.6-.92c-.109-.281-.24-.705-.275-1.485-.038-.843-.046-1.096-.046-3.233s.008-2.388.046-3.231c.036-.78.166-1.204.276-1.486.145-.373.319-.64.599-.92s.546-.453.92-.598c.282-.11.705-.24 1.485-.276.738-.034 1.024-.044 2.515-.045zm4.988 1.328a.96.96 0 1 0 0 1.92.96.96 0 0 0 0-1.92m-4.27 1.122a4.109 4.109 0 1 0 0 8.217 4.109 4.109 0 0 0 0-8.217m0 1.441a2.667 2.667 0 1 1 0 5.334 2.667 2.667 0 0 1 0-5.334"/>\n            </svg>\n        </button>\n        </div>\n        <div>\n        <button id="clippop-mute-player-btn"></button>\n        <button id="clippop-fullscreen-player-btn" class="cp-btn-small" style="display:none">\n            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">\n                <path fill-rule="evenodd" d="M5.828 10.172a.5.5 0 0 0-.707 0l-4.096 4.096V11.5a.5.5 0 0 0-1 0v3.975a.5.5 0 0 0 .5.5H4.5a.5.5 0 0 0 0-1H1.732l4.096-4.096a.5.5 0 0 0 0-.707m4.344 0a.5.5 0 0 1 .707 0l4.096 4.096V11.5a.5.5 0 1 1 1 0v3.975a.5.5 0 0 1-.5.5H11.5a.5.5 0 0 1 0-1h2.768l-4.096-4.096a.5.5 0 0 1 0-.707m0-4.344a.5.5 0 0 0 .707 0l4.096-4.096V4.5a.5.5 0 1 0 1 0V.525a.5.5 0 0 0-.5-.5H11.5a.5.5 0 0 0 0 1h2.768l-4.096 4.096a.5.5 0 0 0 0 .707m-4.344 0a.5.5 0 0 1-.707 0L1.025 1.732V4.5a.5.5 0 0 1-1 0V.525a.5.5 0 0 1 .5-.5H4.5a.5.5 0 0 1 0 1H1.732l4.096 4.096a.5.5 0 0 1 0 .707"/>\n            </svg>\n        </button>        \n        <button id="clippop-close-player-btn">\n            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">\n                <path d="M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707 8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0 1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708"/>\n            </svg>\n        </button>\n        </div>\n        '});E("div",{id:"clippop-play-btn-container",class:"cp-play-btn-container",parentNode:"clippop-buttons-container",htmlContent:'<button id="clippop-play-stop-btn" class="cp-btn-animation-set"></button>'});E("div",{id:"clippop-scroll-btn-container",class:"cp-scroll-btn-container",parentNode:"clippop-buttons-container",htmlContent:'\n        <button id="clippop-scroll-up-btn">\n            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">\n                <path fill-rule="evenodd" d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8m15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-7.5 3.5a.5.5 0 0 1-1 0V5.707L5.354 7.854a.5.5 0 1 1-.708-.708l3-3a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 5.707z"/>\n            </svg>\n        </button>      \n        <button id="clippop-scroll-down-btn">\n            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">\n                <path fill-rule="evenodd" d="M1 8a7 7 0 1 0 14 0A7 7 0 0 0 1 8m15 0A8 8 0 1 1 0 8a8 8 0 0 1 16 0M8.5 4.5a.5.5 0 0 0-1 0v5.793L5.354 8.146a.5.5 0 1 0-.708.708l3 3a.5.5 0 0 0 .708 0l3-3a.5.5 0 0 0-.708-.708L8.5 10.293z"/>\n            </svg>\n        </button>\n        '});Fa();c=Array.from(H("#clippop-shortform-container-wrapper-"+I+" .cp-shortform-info"));oa(c);za(e);Aa();Ba();Ca()},Ja=(b,a)=>{if(b){var c=qa('[name="path_role"]'),f="",d="";if(!a&&"PRODUCT_DETAIL"==c){d="undefined"!==typeof iProductNo?iProductNo:"";if(!d&&S&&void 0!==y.sessionStorage){var g=y.sessionStorage.getItem("localRecentProduct"+S);null!==g&&(g=JSON.parse(g),!d&&g[0].iProductNo&&(d=g[0].iProductNo))}d&&(f="PRODUCT_DETAIL:"+d)}g=a?b.filter(k=>k.clip_uid==a):b.filter(k=>!0===k.is_show&&(k.location.includes("ALL")||k.location.includes(c)||f&&k.location.includes(f)));if(0<g.length){if(!a&&"PRODUCT_DETAIL"==c){var e=Ga(g,d);0<e.length&&(g=e)}e=0;1<g.length&&(e=Math.floor(Math.random()*g.length),g=pa(g));Ia(g[e],a,c,d);console.log("ClipPop is Playing ===>")}else a&&alert("\uc694\uccad\ud558\uc2e0 \ud074\ub9bd\ud31d \uc601\uc0c1\uc774 \uc874\uc7ac\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4.");a||(d=b.filter(k=>!0===k.is_show&&k.location.some(t=>t.startsWith("INLINE"))),0<d.length&&(Da(d),console.log("ClipPop Inline is Playing ===>")));a||(b=b.filter(k=>!0===k.is_show&&k.location.includes("EMBED")),0<b.length&&(setTimeout(Ea,"MAIN"==c?1500:750,b),console.log("ClipPop Embed is Playing ===>")))}},na=b=>{T&&(console.log("ClipPop Start ===>"),fetch(J("aHR0cHM6Ly93aXRoYXBwc2hvc3QubXljYWZlMjQuY29tL2NsaXBwb3AvanNvbj9taWQ9")+T,{method:"GET",headers:{"Content-Type":"application/json"}}).then(function(a){if(!a.ok)throw Error(`HTTP error! status: ${a.status}`);return a.json()}).then(a=>Ja(a,b)).catch(function(a){w(`%c Load Clips failed: ${a}`,"background:#ff0000;color:#fff;")}))};na()})(window,document);
